<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="description" content="scrapyè¯¦è§£"><meta name="keywords" content="scrapy"><meta name="author" content="é€†ã®ç¥æ§˜"><meta name="copyright" content="é€†ã®ç¥æ§˜"><meta name="theme-color" content="#0078E7"><title>scrapyè¯¦è§£ | é€†ã®ç¥æ§˜ã®å°ã•ãªé§…</title><link rel="shortcut icon" href="/fcg22450.github.io/favicon.png"><link rel="mask-icon" href="/fcg22450.github.io/favicon.png" color="#0078E7"><link rel="preload" href="/fcg22450.github.io/css/hexo-theme-yun.css" as="style"><link rel="preload" href="/fcg22450.github.io/js/hexo-theme-yun.js" as="script"><link rel="prefetch" href="/fcg22450.github.io/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="stylesheet" href="/fcg22450.github.io/css/hexo-theme-yun.css"><script id="yun-config">
    let Yun = window.Yun || {};
    let CONFIG = {"root":"/fcg22450.github.io/","title":"é€†ã®ç¥æ§˜ã®å°ã•ãªé§…","version":"0.6.3","anonymous_image":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg","say":{"api":"/fcg22450.github.io/data/sentences.json"},"fireworks":{"colors":["254, 185, 6","223, 47, 47","102, 167, 221","62, 131, 225","33, 78, 194","3, 28, 95","0, 8, 55"]}};
  </script><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@700&amp;family=Source+Code+Pro&amp;display=swap" media="none" onload="this.media='all'"><script src="//at.alicdn.com/t/font_1140697_rtqh36oinzl.js" async></script><meta name="generator" content="Hexo 4.2.0"><link rel="stylesheet" href="/fcg22450.github.io/css/prism.css" type="text/css"></head><body><script defer src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script defer src="/fcg22450.github.io/js/ui/fireworks.js"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle sidebar-toggle-fixed hty-icon-button"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><aside class="sidebar"><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc sidebar-nav-active hty-icon-button" data-target="post-toc-wrap" title="æ–‡ç« ç›®å½•"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="ç«™ç‚¹æ¦‚è§ˆ"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/fcg22450.github.io/about" title="é€†ã®ç¥æ§˜"><img width="96" loading="lazy" src="/fcg22450.github.io/author.jpg" alt="é€†ã®ç¥æ§˜"></a><div class="site-author-name"><a href="/fcg22450.github.io/about/">é€†ã®ç¥æ§˜</a></div><a class="site-name" href="/fcg22450.github.io/about/site.html">é€†ã®ç¥æ§˜ã®å°ã•ãªé§…</a><sub class="site-subtitle">é€†ã®ç¥æ§˜ã®å°ã•ãªé§…</sub><div class="site-desciption">æ½¦å€’ä¸é€šä¸–åŠ¡ï¼Œæ„šé¡½æ€•è¯»æ–‡ç« ã€‚</div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/fcg22450.github.io/" title="é¦–é¡µ"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item site-state-posts"><a href="/fcg22450.github.io/archives" title="å½’æ¡£"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">95</span></a></div><div class="site-state-item site-state-categories"><a href="/fcg22450.github.io/categories" title="åˆ†ç±»"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">13</span></a></div><div class="site-state-item site-state-tags"><a href="/fcg22450.github.io/tags" title="æ ‡ç­¾"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">17</span></a></div><a class="site-state-item hty-icon-button" href="http://fcg22450.gitee.io/new_blog/" target="_blank" rel="noopener" title="éšç¬”"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-settings-line"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="/atom.xml" title="RSS" target="_blank" style="color:orange"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-rss-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://wpa.qq.com/msgrd?v=3&amp;uin=1263893578&amp;site=qq&amp;menu=yes" title="QQ" target="_blank" style="color:#12B7F5"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-qq-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/fcg22450" title="GitHub" target="_blank" style="color:#181717"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-github-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:fcg0322@gmail.com" title="E-Mail" target="_blank" style="color:#8E71C1"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-mail-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://weibo.com/6553522553" title="å¾®åš" target="_blank" style="color:#E6162D"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-weibo-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="/fcg22450.git/images/wechat.jpg" title="å¾®ä¿¡" target="_blank" style="color:#1AAD19"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-wechat-2-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://space.bilibili.com/317139394" title="å“”å“©å“”å“©" target="_blank" style="color:#FF8EB3"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-bilibili-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://travellings.now.sh/" title="Travelling" target="_blank" style="color:black"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-send-plane-2-line"></use></svg></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/fcg22450.github.io/links/" title="æˆ‘çš„å°ä¼™ä¼´ä»¬" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-genderless-line"></use></svg></a><a class="links-item hty-icon-button" href="/fcg22450.github.io/girls/" title="è€å©†ä»¬ ( åš£å¼ çš„æˆ‘~o(*ï¿£â–½ï¿£*)ãƒ–~ )" style="color:hotpink"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-women-line"></use></svg></a></div></div><script defer src="/fcg22450.github.io/js/sidebar.js"></script><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#scrapy"><span class="toc-number">1.</span> <span class="toc-text">scrapy:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#å¦‚ä½•æé«˜scrapyçˆ¬è™«çš„æ•ˆç‡"><span class="toc-number">2.</span> <span class="toc-text">å¦‚ä½•æé«˜scrapyçˆ¬è™«çš„æ•ˆç‡</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#è¯·æ±‚ä¼ å‚"><span class="toc-number">3.</span> <span class="toc-text">è¯·æ±‚ä¼ å‚:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ä¸­é—´ä»¶"><span class="toc-number">4.</span> <span class="toc-text">ä¸­é—´ä»¶:</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#æ‹¦æˆªä¸­é—´ä»¶"><span class="toc-number">4.1.</span> <span class="toc-text">æ‹¦æˆªä¸­é—´ä»¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#UserAgentä¼ªè£…"><span class="toc-number">4.2.</span> <span class="toc-text">UserAgentä¼ªè£…</span></a></li></ol></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="post-block" itemscope itemtype="https://schema.org/Article"><link itemprop="mainEntityOfPage" href="https://github.com/fcg22450/fcg22450.github.io/fcg22450.github.io/2019/05/18/spider/scrapy%E8%AF%A6%E8%A7%A3/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="é€†ã®ç¥æ§˜"><meta itemprop="description" content="scrapyè¯¦è§£"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="é€†ã®ç¥æ§˜ã®å°ã•ãªé§…"></span><header class="post-header"><h1 class="post-title" itemprop="name headline" style="color: undefined">scrapyè¯¦è§£</h1><div class="post-meta"><div class="post-time" style="display:inline-block"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span> <span class="post-meta-icon-text">å‘è¡¨äº</span> <time title="åˆ›å»ºæ—¶é—´ï¼š2019-05-18 00:00:00" itemprop="dateCreated datePublished" datetime="2019-05-18T00:00:00+08:00">2019-05-18</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-2-line"></use></svg></span> <span class="post-meta-icon-text">æ›´æ–°äº</span> <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-05-06 12:53:53" itemprop="dateModified" datetime="2020-05-06T12:53:53+08:00">2020-05-06</time></div><span class="post-busuanzi"><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="é˜…è¯»æ¬¡æ•°"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-eye-line"></use></svg> <span id="busuanzi_value_page_pv"></span></span></span><div class="post-classify"><span class="post-category"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-line"></use></svg></span> <span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category" href="/fcg22450.github.io/categories/python/" itemprop="url" rel="index"><span itemprop="text">python</span></a></span> > <span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category" href="/fcg22450.github.io/categories/python/scrapy/" itemprop="url" rel="index"><span itemprop="text">scrapy</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag" href="/fcg22450.github.io/tags/scrapy/"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">scrapy</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content post-markdown"><h2 id="scrapy"><a href="#scrapy" class="headerlink" title="scrapy:"></a>scrapy:</h2><a id="more"></a>
<ul>
<li><p>ä»€ä¹ˆæ˜¯æ¡†æ¶?</p>
<ul>
<li>ç»§æ‰¿äº†å„ç§åŠŸèƒ½ä¸”å…·æœ‰å¾ˆå¼ºé€šç”¨æ€§(å¯ä»¥è¢«åº”ç”¨åœ¨å„ç§ä¸åŒçš„éœ€æ±‚ä¸­)çš„ä¸€ä¸ªé¡¹ç›®æ¨¡æ¿</li>
<li>æˆ‘ä»¬éœ€è¦åšçš„å°±æ˜¯å­¦ä¹ æ€ä¹ˆä½¿ç”¨è¿™äº›æ¡†æ¶çš„åŠŸèƒ½</li>
</ul>
</li>
<li><p>scrapyæ¡†æ¶é›†æˆçš„åŠŸèƒ½æœ‰å“ªäº›?</p>
<ul>
<li>é«˜æ€§èƒ½çš„æ•°æ®è§£ææ“ä½œ</li>
<li>é«˜æ€§èƒ½çš„æ•°æ®ä¸‹è½½æ“ä½œ</li>
<li>æŒä¹…åŒ–æ•°æ®å­˜å‚¨</li>
</ul>
</li>
<li><p>scrapyé€šå¸¸åªç”¨äºgetè¯·æ±‚,å¹¶ä¸é€‚ç”¨äºpostè¯·æ±‚çš„æ¨¡æ‹Ÿç™»é™†</p>
</li>
<li><p>scrapyç¯å¢ƒå®‰è£…</p>
<ol>
<li>pip install wheel</li>
<li>pip install twisted<ul>
<li><a href="https://pypi.org/project/Twisted/#files" target="_blank" rel="noopener">twistedä¸‹è½½</a></li>
</ul>
</li>
<li>pip install pywin32</li>
<li>pip install scrapy</li>
</ol>
</li>
<li><p>å¼€å§‹åˆ›å»ºscrapyå·¥ç¨‹</p>
<ul>
<li>è¿›å…¥ç»ˆç«¯è¾“å…¥æŒ‡ä»¤åˆ›å»ºæ–°çš„scrapyå·¥ç¨‹</li>
<li>â€˜scrapy startproject projectnameâ€™</li>
<li>æŒ‰ç…§æŒ‡ä»¤åˆ›å»ºæ–°çš„çˆ¬è™«æ–‡ä»¶ </li>
<li>scrapy genspider spiderName <a href="http://www.xxx.com" target="_blank" rel="noopener">www.xxx.com</a></li>
<li>å¯åŠ¨çˆ¬è™«ç¨‹åº<ul>
<li>scrapyçˆ¬è™«ä¸èƒ½ç›´æ¥è¿è¡Œ,</li>
<li>åœ¨å‘½ä»¤çª—å£ä¸­è¾“å…¥æŒ‡ä»¤</li>
<li>scrapy crawl spiderName<ul>
<li>scrapy crawl spiderName â€“nolog</li>
<li>è¿è¡Œæ—¶ä¸è¾“å‡ºæ—¥å¿—ä¿¡æ¯</li>
<li>åœ¨settingæ–‡ä»¶ä¸­æ·»åŠ é…ç½®</li>
<li>LOG_LEVEL= â€˜ERRORâ€™â€™</li>
<li>å½“å‘ç”Ÿé”™è¯¯æ—¶,å°†é”™è¯¯æ—¥å¿—è¾“å‡º,æ–¹ä¾¿è°ƒè¯•</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>scrapyå·¥ç¨‹è®¾ç½®â€“â€”â€“-setting</p>
<ul>
<li>User_Agent    è¿™é‡Œè®¾ç½®çš„æ˜¯çˆ¬è™«çš„è¯·æ±‚å¤´</li>
<li>ROBOTSTXT_OBEY = True   è¿™é‡Œè®¾ç½®çš„æ˜¯robotsåè®®,å½“å€¼ä¸ºTrueæ—¶,çˆ¬è™«å°†ä¼šåœ¨è¿è¡Œæ—¶ä¼˜å…ˆæŸ¥çœ‹robotsåè®®,å¦‚æœåè®®ä¸å…è®¸å°†ä¸ä¼šè¿›è¡Œçˆ¬å–</li>
</ul>
</li>
<li><p>scrapyå·¥ç¨‹ä½¿ç”¨</p>
<ul>
<li><p>æ„å»ºè§£æ</p>
</li>
<li><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># -*- coding: utf-8 -*-</span>
<span class="token keyword">import</span> scrapy
<span class="token keyword">class</span> <span class="token class-name">NewSpiderSpider</span><span class="token punctuation">(</span>scrapy<span class="token punctuation">.</span>Spider<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment" spellcheck="true"># çˆ¬è™«æ–‡ä»¶çš„åç§°,ç›¸å½“äºçˆ¬è™«æ–‡ä»¶çš„å”¯ä¸€æ ‡è¯†</span>
    name <span class="token operator">=</span> <span class="token string">'ğŸ’€'</span>
    <span class="token comment" spellcheck="true"># å¾ªåºçš„åŸŸå, é€šå¸¸æƒ…å†µä¸‹ä¸ä¼šä½¿ç”¨</span>
    <span class="token comment" spellcheck="true"># allowed_domains = ['www.baidu.com']</span>
    <span class="token comment" spellcheck="true"># èµ·å§‹çš„urlåˆ—è¡¨, scrapyå°†ä¼šå¯¹åˆ—è¡¨ä¸­çš„urlè‡ªåŠ¨è¿›è¡Œè¯·æ±‚å‘é€</span>
    start_urls <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'http://www.budejie.com/'</span><span class="token punctuation">]</span>

    <span class="token keyword">def</span> <span class="token function">parse</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment" spellcheck="true"># åœ¨scrapyä¸­,æ•°æ®è§£æä¸éœ€è¦æ‰‹åŠ¨å¯¼å…¥etreeæ¥è¿›è¡Œ,ç›¸å¯¹çš„,è¿™é‡Œé¢é›†æˆäº†etree çš„åŠŸèƒ½,ä¹Ÿå°±æ˜¯è¯´,æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨scrapyçš„é›†æˆæ¥è¾¾åˆ°æˆ‘ä»¬è¿›è¡Œæ•°æ®è§£æçš„ç›®æ ‡</span>
        <span class="token comment" spellcheck="true"># è¿™ä¸ªåŠŸèƒ½çš„ä½¿ç”¨æ–¹å¼å¦‚ä¸‹</span>
        res <span class="token operator">=</span> response<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="j-r-list-c-desc"]/a/text()'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment" spellcheck="true"># extractæ–¹æ³•,æå–è·å–åˆ°çš„selectedå¯¹è±¡ä¸­çš„dataæ•°æ®,å½“å¯¹è±¡ä¸ºå•ä¸ªå¯¹è±¡çš„æ—¶å€™,è·å–åˆ°çš„å¯¹è±¡å°±æ˜¯å•ä¸ªçš„å­—ç¬¦ä¸²,</span>
        <span class="token comment" spellcheck="true"># å½“æå–åˆ°çš„selectedå¯¹è±¡ä¸ºlistå¯¹è±¡æ—¶,è·å–åˆ°çš„æ•°æ®ä¹Ÿä¼šè‡ªåŠ¨å˜æˆä¸€ä¸ªåˆ—è¡¨,å¹¶ä¸éœ€è¦å¾ªç¯éå†selectedåˆ—è¡¨æ¥è¿›è¡Œæå–</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> res<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span></code></pre>
</li>
</ul>
</li>
<li><p>scrapyæŒä¹…åŒ–å­˜å‚¨</p>
<ul>
<li><p>åŸºäºç»ˆç«¯çª—å£çš„æŒä¹…åŒ–å­˜å‚¨</p>
<ul>
<li><p>ç‰¹æ€§:åªå¯ä»¥å°†parseæ–¹æ³•çš„è¿”å›å€¼å†™å…¥åˆ°æœ¬åœ°çš„ç£ç›˜æ–‡ä»¶ä¸­</p>
</li>
<li><p>æŒ‡ä»¤: scrapy crawl spiderName -o filePath</p>
</li>
<li><pre class=" language-python"><code class="language-python">    <span class="token keyword">def</span> <span class="token function">parse</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">:</span>
        li_list <span class="token operator">=</span> response<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="j-r-list"]/ul/li'</span><span class="token punctuation">)</span>
        all_data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> li <span class="token keyword">in</span> li_list<span class="token punctuation">:</span>
            author <span class="token operator">=</span> li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'./div[1]/div[2]/a/text()'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            content <span class="token operator">=</span> li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'./div[2]/div[1]/a/text()'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            dic <span class="token operator">=</span> <span class="token punctuation">{</span>
                <span class="token string">'Author'</span><span class="token punctuation">:</span> author<span class="token punctuation">,</span>
                <span class="token string">'Content'</span><span class="token punctuation">:</span> content
            <span class="token punctuation">}</span>
            all_data<span class="token punctuation">.</span>append<span class="token punctuation">(</span>dic<span class="token punctuation">)</span>
        <span class="token keyword">return</span> all_data
<span class="token comment" spellcheck="true"># scrapy å°†ä¼šå¯¹parseçš„è¿”å›å€¼è¿›è¡Œå¤„ç†,å¹¶é¢„ç½®äº†å†…éƒ¨çš„æŒä¹…åŒ–å­˜å‚¨æ¨¡å—.è¿™ä¸ªæŒä¹…åŒ–å­˜å‚¨åŸºäºå‘½ä»¤ç»ˆç«¯è¿è¡Œ,è¯¥é€‰é¡¹ä¸æ”¯æŒtxtæ–‡ä»¶å­˜å‚¨,ç›®å‰ä»…æ”¯æŒ('json', 'jsonlines', 'jl', 'csv', 'xml', 'marshal', 'pickle')è¿™ä¸ƒç§æ–‡ä»¶</span></code></pre>
</li>
<li></li>
</ul>
</li>
<li><p>åŸºäºç®¡é“çš„æŒä¹…åŒ–å­˜å‚¨</p>
<ul>
<li><p>ç®¡é“è¯å­˜å‚¨éœ€è¦ä½¿ç”¨scrapyä¸­å°å­˜çš„ä¸€äº›æ–¹æ³•,åŒæ—¶éœ€è¦è¿›è¡Œä¸€äº›å¤„ç†,è¿™æ ·çš„å­˜å‚¨æ–¹å¼æ”¯æŒtxtæ–‡æ¡£å­˜å‚¨</p>
</li>
<li><p>ç®¡é“æ–‡ä»¶å­˜å‚¨ç¤ºä¾‹:</p>
</li>
<li><pre class=" language-python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">FirstblodPipeline</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">:</span>
    fp <span class="token operator">=</span> None
    <span class="token comment" spellcheck="true"># è®¾å®šåœ¨ç®¡é“è¿è¡Œå¼€å§‹ä¹‹å‰ä¼˜å…ˆè¿è¡Œçš„ä»£ç </span>
    <span class="token keyword">def</span> <span class="token function">open_spider</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> spider<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'çˆ¬è™«å¼€å§‹è¿è¡Œ~~~~~~~'</span><span class="token punctuation">)</span>
        <span class="token comment" spellcheck="true"># é€šè¿‡åœ¨ç®¡é“è¿è¡Œå¼€å§‹ä¹‹å‰æ‰“å¼€æ–‡ä»¶çš„å½¢å¼æ¥ç¡®ä¿è¿™ä¸ªæ–‡ä»¶æ¯æ¬¡åªéœ€è¦æ‰“å¼€ä¸€æ¬¡</span>
        self<span class="token punctuation">.</span>fp <span class="token operator">=</span> open<span class="token punctuation">(</span><span class="token string">'./firstBlod/spiders/all_data.txt'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>

    <span class="token comment" spellcheck="true"># å½“æ•°æ®è¢«æäº¤æ—¶æ‰§è¡Œçš„ä»£ç ,åœ¨è¿™é‡Œè¿›è¡Œæ•°æ®æŒä¹…åŒ–å­˜å‚¨</span>
    <span class="token keyword">def</span> <span class="token function">process_item</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> item<span class="token punctuation">,</span> spider<span class="token punctuation">)</span><span class="token punctuation">:</span>
        author <span class="token operator">=</span> item<span class="token punctuation">[</span><span class="token string">'author'</span><span class="token punctuation">]</span>
        content <span class="token operator">=</span> item<span class="token punctuation">[</span><span class="token string">'content'</span><span class="token punctuation">]</span>
        <span class="token comment" spellcheck="true"># è°ƒç”¨å·²ç»æ‰“å¼€çš„æ–‡ä»¶,å¹¶åœ¨é‡Œé¢è¿›è¡Œå†™å…¥æ“ä½œ</span>
        self<span class="token punctuation">.</span>fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span>author <span class="token operator">+</span> <span class="token string">':'</span> <span class="token operator">+</span> content <span class="token operator">+</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>
        <span class="token comment" spellcheck="true"># å°†itemè½¬äº¤ç»™ä¸‹ä¸€ä¸ªç®¡é“ç±»</span>
        <span class="token keyword">return</span> item
    <span class="token comment" spellcheck="true"># å½“ç®¡é“å…³é—­æ—¶æ‰§è¡Œçš„ä»£ç </span>
    <span class="token keyword">def</span> <span class="token function">close_spider</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> spider<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'çˆ¬è™«ç»“æŸè¿è¡Œ~~~~~~~'</span><span class="token punctuation">)</span>
        <span class="token comment" spellcheck="true"># åœ¨ä»£ç æ•´ä½“è¿è¡Œç»“æŸçš„æ—¶å€™,å…³é—­æ‰“å¼€çš„æ–‡ä»¶</span>
        self<span class="token punctuation">.</span>fp<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
</li>
<li><p>itemæ–‡ä»¶å¯¹è±¡å®ä¾‹</p>
</li>
<li><pre class=" language-python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">FirstblodItem</span><span class="token punctuation">(</span>scrapy<span class="token punctuation">.</span>Item<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment" spellcheck="true"># define the fields for your item here like:</span>
    <span class="token comment" spellcheck="true"># name = scrapy.Field()</span>
    <span class="token comment" spellcheck="true"># æ„å»ºæ–°çš„itemå¯¹è±¡ä¸­çš„å‚æ•°</span>
    <span class="token comment" spellcheck="true"># æ ¼å¼ä¸º    name = scrapy.Field()</span>
    <span class="token comment" spellcheck="true"># ä½¿ç”¨fieldæ–‡ä»¶æ ¼å¼çš„æ—¶å€™,å…¼å®¹å‡ ä¹æ‰€æœ‰çš„æ–‡ä»¶ç±»å‹</span>
    <span class="token comment" spellcheck="true"># åŒ…æ‹¬ä½†ä¸ä»…é™äº   åˆ—è¡¨,å…ƒç»„,å­—å…¸,å­—ç¬¦ä¸²,æ•°å­—,äºŒè¿›åˆ¶æµç­‰å„ç§å„æ ·çš„å½¢å¼</span>
    author <span class="token operator">=</span> scrapy<span class="token punctuation">.</span>Field<span class="token punctuation">(</span><span class="token punctuation">)</span>
    content <span class="token operator">=</span> scrapy<span class="token punctuation">.</span>Field<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
</li>
<li><p>settingsæ–‡ä»¶å®ä¾‹</p>
</li>
<li><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># Configure item pipelines</span>
<span class="token comment" spellcheck="true"># See https://docs.scrapy.org/en/latest/topics/item-pipeline.html</span>
ITEM_PIPELINES <span class="token operator">=</span> <span class="token punctuation">{</span>
   <span class="token string">'firstBlod.pipelines.FirstblodPipeline'</span><span class="token punctuation">:</span> <span class="token number">300</span><span class="token punctuation">,</span>
    <span class="token comment" spellcheck="true"># ç®¡é“å¯¹è±¡çš„åå­—,åé¢çš„æ•°å€¼ä¸ºç®¡é“ä¼˜å…ˆå€¼</span>
    <span class="token comment" spellcheck="true"># ä¼˜å…ˆå€¼é«˜çš„å°†ä¼šä¼˜å…ˆæ‰§è¡Œ</span>
    <span class="token comment" spellcheck="true"># æ•°å€¼è¶Šä½ä¼˜å…ˆå€¼è¶Šé«˜</span>
<span class="token punctuation">}</span></code></pre>
</li>
<li><p>æ‰¾åˆ°ç®¡é“ç›¸å…³ä»£ç è¿›è¡Œæ¿€æ´»</p>
</li>
<li><p>åœ¨çˆ¬è™«æ–‡ä»¶ä¸­è¿›è¡Œä½¿ç”¨</p>
</li>
<li><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> scrapy
<span class="token keyword">from</span> firstBlod<span class="token punctuation">.</span>items <span class="token keyword">import</span> FirstblodItem
<span class="token comment" spellcheck="true"># å¯¼å…¥itemè®¾å®šç±»</span>
<span class="token keyword">class</span> <span class="token class-name">NewSpiderSpider</span><span class="token punctuation">(</span>scrapy<span class="token punctuation">.</span>Spider<span class="token punctuation">)</span><span class="token punctuation">:</span>
    name <span class="token operator">=</span> <span class="token string">'ğŸ’€'</span>
    start_urls <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'http://www.budejie.com/'</span><span class="token punctuation">]</span>

    <span class="token keyword">def</span> <span class="token function">parse</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">:</span>
        li_list <span class="token operator">=</span> response<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="j-r-list"]/ul/li'</span><span class="token punctuation">)</span>
        <span class="token comment" spellcheck="true"># all_data = []</span>
        <span class="token keyword">for</span> li <span class="token keyword">in</span> li_list<span class="token punctuation">:</span>
            author <span class="token operator">=</span> li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'./div[1]/div[2]/a/text()'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            content <span class="token operator">=</span> li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'./div[2]/div[1]/a/text()'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            item <span class="token operator">=</span> FirstblodItem<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token comment" spellcheck="true"># å®ä¾‹åŒ–itemå¯¹è±¡</span>
            item<span class="token punctuation">[</span><span class="token string">'author'</span><span class="token punctuation">]</span> <span class="token operator">=</span> author
            item<span class="token punctuation">[</span><span class="token string">'content'</span><span class="token punctuation">]</span> <span class="token operator">=</span> content
            <span class="token comment" spellcheck="true"># itemä½¿ç”¨æ–¹æ³•å’Œå­—å…¸ç±»ä¼¼</span>
            <span class="token comment" spellcheck="true"># ä½¿ç”¨yieldæ–¹æ³•è¿”å›å°è£…å®Œæˆçš„itemå¯¹è±¡</span>
            <span class="token comment" spellcheck="true"># å½“ä½¿ç”¨yieldè¿”å›çš„æ—¶å€™,å°†ä¼šè‡ªåŠ¨å°†itemä¼ è¾“åˆ°ç®¡é“å¯¹åº”çš„æ¥å—ç±»ä¸­,è¿›è¡Œå¤„ç†å¹¶æŒä¹…åŒ–å­˜å‚¨</span>
            <span class="token keyword">yield</span> item</code></pre>
</li>
<li><p>å°†ä¸Šè¿°æ¡ä»¶å‡†å¤‡å®Œæ¯•ä¹‹å,å°±å¯ä»¥è¿›è¡Œæ•°æ®çš„æŒä¹…åŒ–å­˜å‚¨äº†</p>
</li>
<li><p>å½“ç„¶,ä¹Ÿä¸ä¸€å®šéè¦å­˜å‚¨åˆ°æ–‡ä»¶ä¸­å»,æ¯•ç«Ÿè¿˜æœ‰ä¸€äº›æ¶‰åŠåˆ°æ•°æ®åº“çš„å­˜å‚¨,éƒ½å¯ä»¥æ”¾åˆ°è¿™ä¸ªç®¡é“ä¸­æ¥è¿›è¡Œ</p>
</li>
<li><p>ä¹Ÿå°±æ˜¯,ç®¡é“æ–‡ä»¶ä¸­çš„ä¸€ä¸ªç®¡é“ç±»è´Ÿè´£ä¸€ç§æŒä¹…åŒ–å­˜å‚¨çš„æ–¹æ¡ˆ</p>
</li>
<li><p>itemæäº¤çš„æ—¶å€™å°†ä¼šæŠŠitemäº¤ç»™ä¼˜å…ˆçº§æœ€é«˜çš„ç®¡é“ç±»</p>
</li>
<li><p>åœ¨ç®¡é“ç±»ä¸­,return itemçš„ä½œç”¨æ˜¯å°†itemè½¬äº¤ç»™ä¸‹ä¸€ä¸ªç®¡é“ç±»</p>
</li>
<li><p>åŒç®¡é“ç±»å†™æ³•ä»¥åŠMysqlæ•°æ®åº“å†™å…¥</p>
</li>
<li><pre class=" language-python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">MysqlPip</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">:</span>
    conn <span class="token operator">=</span> None
    cursor <span class="token operator">=</span> None

    <span class="token comment" spellcheck="true"># è®¾å®šåœ¨ç®¡é“è¿è¡Œå¼€å§‹ä¹‹å‰ä¼˜å…ˆè¿è¡Œçš„ä»£ç </span>
    <span class="token keyword">def</span> <span class="token function">open_spider</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> spider<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment" spellcheck="true"># é€šè¿‡åœ¨ç®¡é“è¿è¡Œå¼€å§‹ä¹‹å‰æ‰“å¼€æ–‡ä»¶çš„å½¢å¼æ¥ç¡®ä¿è¿™ä¸ªæ–‡ä»¶æ¯æ¬¡åªéœ€è¦æ‰“å¼€ä¸€æ¬¡</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'çˆ¬è™«2å¼€å§‹è¿è¡Œ~~~~~~~'</span><span class="token punctuation">)</span>
        <span class="token comment" spellcheck="true"># å»ºç«‹æ•°æ®åº“æ¸¸æ ‡</span>
        self<span class="token punctuation">.</span>conn <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>Connect<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span>port<span class="token operator">=</span><span class="token number">3306</span><span class="token punctuation">,</span>user<span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">,</span>password<span class="token operator">=</span><span class="token string">'000000'</span><span class="token punctuation">,</span>db<span class="token operator">=</span><span class="token string">'spider'</span><span class="token punctuation">,</span>charset<span class="token operator">=</span><span class="token string">'utf8'</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>conn<span class="token punctuation">)</span>
    <span class="token comment" spellcheck="true"># å½“æ•°æ®è¢«æäº¤æ—¶æ‰§è¡Œçš„ä»£ç ,åœ¨è¿™é‡Œè¿›è¡Œæ•°æ®æŒä¹…åŒ–å­˜å‚¨</span>
    <span class="token keyword">def</span> <span class="token function">process_item</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> item<span class="token punctuation">,</span> spider<span class="token punctuation">)</span><span class="token punctuation">:</span>
        author <span class="token operator">=</span> item<span class="token punctuation">[</span><span class="token string">'author'</span><span class="token punctuation">]</span>
        content <span class="token operator">=</span> item<span class="token punctuation">[</span><span class="token string">'content'</span><span class="token punctuation">]</span>
        sql <span class="token operator">=</span> <span class="token string">'insert into bs values ("%s","%s")'</span><span class="token operator">%</span> <span class="token punctuation">(</span>author<span class="token punctuation">,</span>content<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>cursor <span class="token operator">=</span> self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>rollback<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'----------------------------------------------------------------------------'</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> item
    <span class="token keyword">def</span> <span class="token function">close_spider</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> spider<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'çˆ¬è™«2ç»“æŸè¿è¡Œ~~~~~~~'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>cursor<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
</li>
</ul>
</li>
<li><p>æ‰‹åŠ¨å‘é€è¯·æ±‚:</p>
<ul>
<li><p>æ‰‹åŠ¨å‘é€getè¯·æ±‚</p>
<ul>
<li><p>åº”ç”¨åœºæ™¯:   è¯·æ±‚åŒä¸€ä¸ªä¸»é¡µé¢ä¸‹çš„å¤šä¸ªé¡µé¢</p>
</li>
<li><p>ä»£ç </p>
<pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># -*- coding: utf-8 -*-</span>
<span class="token keyword">import</span> scrapy
<span class="token keyword">from</span> firstBlod<span class="token punctuation">.</span>items <span class="token keyword">import</span> FirstblodItem

<span class="token keyword">class</span> <span class="token class-name">NewSpiderSpider</span><span class="token punctuation">(</span>scrapy<span class="token punctuation">.</span>Spider<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment" spellcheck="true"># çˆ¬è™«æ–‡ä»¶çš„åç§°,ç›¸å½“äºçˆ¬è™«æ–‡ä»¶çš„å”¯ä¸€æ ‡è¯†</span>
    name <span class="token operator">=</span> <span class="token string">'new_spider'</span>
    <span class="token comment" spellcheck="true"># å¾ªåºçš„åŸŸå, é€šå¸¸æƒ…å†µä¸‹ä¸ä¼šä½¿ç”¨</span>
    <span class="token comment" spellcheck="true"># allowed_domains = ['www.baidu.com']</span>
    <span class="token comment" spellcheck="true"># èµ·å§‹çš„urlåˆ—è¡¨, scrapyå°†ä¼šå¯¹åˆ—è¡¨ä¸­çš„urlè‡ªåŠ¨è¿›è¡Œè¯·æ±‚å‘é€</span>
    start_urls <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token string">'https://www.zhipin.com/job_detail/?query=python&amp;city=101010100&amp;industry=&amp;position='</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span>
    <span class="token comment" spellcheck="true"># è®¾ç½®åŸºæœ¬çš„urlæ¨¡æ¿</span>
    url <span class="token operator">=</span> <span class="token string">'https://www.zhipin.com/c101010100/?query=python&amp;page=%d&amp;ka=page-%d'</span>
    <span class="token comment" spellcheck="true"># è®°å½•é¡µæ•°</span>
    page_name <span class="token operator">=</span> <span class="token number">1</span>

    <span class="token keyword">def</span> <span class="token function">parse</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">:</span>
        li_list <span class="token operator">=</span> response<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="job-list"]'</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>li_list<span class="token punctuation">)</span>
        <span class="token comment" spellcheck="true"># all_data = []</span>
        <span class="token keyword">for</span> li <span class="token keyword">in</span> li_list<span class="token punctuation">:</span>
            <span class="token comment" spellcheck="true"># èŒä½åç§°</span>
            Job_title <span class="token operator">=</span> li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'./div/div[1]/h3/a/div[1]/text()'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            <span class="token comment" spellcheck="true"># å…¬å¸åç§°</span>
            Corporate_name <span class="token operator">=</span> li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'./div/div[1]/a/text()'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            <span class="token comment" spellcheck="true"># åœ°å€</span>
            all_address <span class="token operator">=</span> li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'./div/div[1]/p//text()'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            <span class="token comment" spellcheck="true"># ç»éªŒ experience</span>
            <span class="token comment" spellcheck="true"># address,experience,Education = all_address.split('|')</span>
            <span class="token comment" spellcheck="true">#å­¦å† Education</span>
            <span class="token comment" spellcheck="true"># dic = {</span>
            <span class="token comment" spellcheck="true">#     'Author': author,</span>
            <span class="token comment" spellcheck="true">#     'Content': content</span>
            <span class="token comment" spellcheck="true"># }</span>
            <span class="token comment" spellcheck="true"># all_data.append(dic)</span>
            item <span class="token operator">=</span> FirstblodItem<span class="token punctuation">(</span><span class="token punctuation">)</span>
            item<span class="token punctuation">[</span><span class="token string">'Job_title'</span><span class="token punctuation">]</span> <span class="token operator">=</span> Job_title
            item<span class="token punctuation">[</span><span class="token string">'Corporate_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> Corporate_name
            <span class="token keyword">yield</span> item
        <span class="token comment" spellcheck="true"># ç¡®å®šå½“å‰é¡µæ•°,</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>page_name <span class="token operator">&lt;=</span> <span class="token number">5</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>page_name <span class="token operator">+=</span> <span class="token number">1</span>
            <span class="token comment" spellcheck="true"># æ‹¼æ¥æ–°çš„url</span>
            new_url <span class="token operator">=</span> format<span class="token punctuation">(</span>self<span class="token punctuation">.</span>url<span class="token operator">%</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>page_name<span class="token punctuation">,</span>self<span class="token punctuation">.</span>page_name<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token comment" spellcheck="true"># ä½¿ç”¨yieldè¿›è¡Œè¯·æ±‚,å‚æ•°callbackä¸ºå¤„ç†è¿™äº›é¡µé¢ä¿¡æ¯æ‰€ç”¨çš„å‡½æ•°,å¯è‡ªè¡Œè®¾å®š,ä¹Ÿå¯ç”¨é€’å½’çš„æ–¹å¼ä½¿ç”¨å½“å‰çš„å‡½æ•°</span>
            <span class="token keyword">yield</span> scrapy<span class="token punctuation">.</span>Request<span class="token punctuation">(</span>new_url<span class="token punctuation">,</span>callback<span class="token operator">=</span>self<span class="token punctuation">.</span>parse<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> li_list</code></pre>
</li>
<li><p>é‡å†™çˆ¶ç±»çš„è‡ªåŠ¨è¯·æ±‚æ–¹æ³•</p>
<pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># é‡å†™çˆ¶ç±»æ–¹æ³•æ„å‘³ç€æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰æ•°æ®æ¸…æ´—å‡½æ•°,è€Œä¸éœ€è¦å±€é™äºparse</span>
<span class="token keyword">def</span> <span class="token function">start_requests</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> url <span class="token keyword">in</span> self<span class="token punctuation">.</span>start_urls<span class="token punctuation">:</span>
        <span class="token keyword">yield</span> scrapy<span class="token punctuation">.</span>Request<span class="token punctuation">(</span>url<span class="token punctuation">,</span>callback<span class="token operator">=</span>self<span class="token punctuation">.</span>parse<span class="token punctuation">)</span></code></pre>
</li>
<li><p>è¦æƒ³ä½¿scrapyè‡ªåŠ¨å‘é€getè¯·æ±‚,éœ€è¦é‡å†™start_requestsæ–¹æ³•</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<pre><code>## scrapyå›¾ç‰‡å¤„ç†:</code></pre><ol>
<li><p>åœ¨scrapyä¸­,æœ‰ç€ä¸“é—¨çš„æ¨¡å—å¯¹å›¾ç‰‡æ•°æ®è¿›è¡Œè¯·æ±‚ä»¥åŠå¤„ç†,æˆ‘ä»¬åªéœ€è¦å°†è·å–åˆ°çš„å›¾ç‰‡urlä»¥itemçš„å½¢å¼ä¼ è¾“åˆ°æˆ‘ä»¬çš„ç®¡é“ä¹‹ä¸­è¿›è¡Œå¤„ç†å³å¯,itemå¯¹è±¡çš„åˆ›å»ºäºå¯»å¸¸çš„åˆ›å»ºæ–¹æ³•æ²¡è®¾ä¹ˆåŒºåˆ«,scrapy.FieldsåŒ…å®¹æ€§æå¼º,ä¸éœ€è¦è€ƒè™‘å…¼å®¹æ€§é—®é¢˜,</p>
</li>
<li><p>åœ¨æäº¤åˆ°ç®¡é“ä¸­å»ä¹‹å,æˆ‘ä»¬å¯ä»¥åœ¨ç®¡é“ä¹‹ä¸­å¯¹itemä¸­çš„æ•°æ®è¿›è¡Œå¤„ç†,</p>
</li>
<li><p>ä½¿ç”¨scrapyä¸­å°è£…çš„å›¾ç‰‡å¤„ç†ä¸“ç”¨ç±»scrapy.pipelines.images import ImagePipeline</p>
</li>
<li><p>åˆ›å»ºä¸€ä¸ªæ–°çš„ç®¡é“ç±»,è¿™ä¸ªç®¡é“ç±»ç»§æ‰¿è‡ªImagePipline</p>
</li>
<li><pre class=" language-python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">ImgSpidersPipeline</span><span class="token punctuation">(</span>ImagesPipeline<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token comment" spellcheck="true"># å¯¹ä¸€ä¸ªå›¾ç‰‡é“¾æ¥è¿›è¡Œè¯·æ±‚å‘é€</span>
    <span class="token comment" spellcheck="true"># item å°±æ˜¯scrapyæäº¤è¿‡æ¥çš„itemæ•°æ®</span>
    <span class="token keyword">def</span> <span class="token function">get_media_requests</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> item<span class="token punctuation">,</span> info<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">yield</span> scrapy<span class="token punctuation">.</span>Request<span class="token punctuation">(</span>item<span class="token punctuation">[</span><span class="token string">'src'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    <span class="token comment" spellcheck="true"># å‡†å¤‡æ–‡ä»¶å</span>
    <span class="token keyword">def</span> <span class="token function">file_path</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> response<span class="token operator">=</span>None<span class="token punctuation">,</span> info<span class="token operator">=</span>None<span class="token punctuation">)</span><span class="token punctuation">:</span>
        file_name <span class="token operator">=</span> request<span class="token punctuation">.</span>url<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'æ­£åœ¨ä¸‹è½½'</span><span class="token punctuation">,</span>file_name<span class="token punctuation">,</span><span class="token string">'............'</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> file_name
    <span class="token comment" spellcheck="true"># å°†itemä¼ é€’ç»™ä¸‹ä¸€ä¸ªå³å°†æ‰§è¡Œçš„ç®¡é“ç±»</span>
    <span class="token keyword">def</span> <span class="token function">item_completed</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> results<span class="token punctuation">,</span> item<span class="token punctuation">,</span> info<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> item</code></pre>
</li>
<li><p>å®Œæˆè¿™äº›ä¹‹å,æˆ‘ä»¬è¿˜éœ€è¦å¯¹å›¾ç‰‡çš„å­˜å‚¨è·¯å¾„è¿›è¡Œè®¾ç½®,åœ¨settingæ–‡ä»¶ä¸­æ·»åŠ æ–°çš„å±æ€§</p>
<ul>
<li><p>IMAGES_STORE = â€œimagePathâ€</p>
</li>
<li><p>imagePathè‡ªè¡Œè®¾ç½®,æœ€å¥½è®¾ç½®ä¸ºç»å¯¹è·¯å¾„,å¦‚æœä½¿ç”¨ç›¸å¯¹è·¯å¾„çš„è¯,æœ€å¥½å‚è€ƒdjangoä¸­çš„æ–‡ä»¶è·¯å¾„çš„å†™æ³•,å…ˆç¡®å®šå·¥ç¨‹çš„è·¯å¾„,ç„¶åå†åœ¨å·¥ç¨‹è·¯å¾„çš„åŸºç¡€ä¸Šè®¾å®šç›¸å¯¹è·¯å¾„</p>
</li>
<li><p>djangoæ–¹æ³•è®¾ç½®è·¯å¾„å¦‚ä¸‹:</p>
</li>
<li><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> os
<span class="token comment" spellcheck="true"># è·å–å½“å‰æ–‡ä»¶å¤¹çš„ä¸»è·¯å¾„</span>
BASE_DIR <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>abspath<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># å°†è¦æ·»åŠ çš„å›¾ç‰‡æ–‡ä»¶ä¿å­˜è·¯å¾„åŠ å…¥åˆ°ä¸»è·¯å¾„ä¸­å»</span>
IMAGES_STORE <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>BASE_DIR<span class="token punctuation">,</span><span class="token string">'imgsLib'</span><span class="token punctuation">)</span></code></pre>
</li>
<li><p>è¿™ä¸ªæ–¹æ³•åŒæ ·è®¾ç½®åœ¨settingsæ–‡ä»¶ä¸­</p>
</li>
</ul>
</li>
<li><p>å®Œæˆè¿™äº›ä¹‹å,åªéœ€è¦åœ¨settingsä¸­å°†å†™å¥½çš„ç®¡é“ç±»è¿›è¡Œæ³¨å†Œ,å³å¯å¼€å§‹è¿™ä¸ªç®¡é“ç±»</p>
</li>
<li><p>è¿è¡Œçˆ¬è™«ç¨‹åº,å°†ä¼šå¼€å§‹å…¨è‡ªåŠ¨ä¸‹è½½é€‰ä¸­çš„å›¾ç‰‡,æ ¹æ®ä¹‹å‰å­¦è¿‡çš„æ–¹æ³•,å³è®¾å®šç½‘å€çš„åŸºç¡€æ¨¡æ¿,å³å¯å®ç°å›¾ç‰‡çš„æ‰¹é‡ä¸‹è½½</p>
</li>
</ol>
<h2 id="å¦‚ä½•æé«˜scrapyçˆ¬è™«çš„æ•ˆç‡"><a href="#å¦‚ä½•æé«˜scrapyçˆ¬è™«çš„æ•ˆç‡" class="headerlink" title="å¦‚ä½•æé«˜scrapyçˆ¬è™«çš„æ•ˆç‡"></a>å¦‚ä½•æé«˜scrapyçˆ¬è™«çš„æ•ˆç‡</h2><ol>
<li>å¢åŠ å¹¶å‘æ•°é‡<ul>
<li>CONCURRENT_REQUESTS = 32</li>
<li>é»˜è®¤å¹¶å‘æ•°é‡ä¸º32</li>
<li>å¯ä»¥è‡ªè¡Œè®¾ç½®</li>
</ul>
</li>
<li>é™ä½æ—¥å¿—ç­‰çº§<ul>
<li>LOG_LEVEL = â€œINFOâ€</li>
<li>LOG_LEVEL = â€œERRORâ€</li>
</ul>
</li>
<li>ç¦æ­¢cookie<ul>
<li>COOKIES_ENABLED = False</li>
<li>åœ¨scrapyä¸­ä¼šè‡ªåŠ¨å¯¹cookieè¿›è¡Œå¤„ç†,ä¸ç®¡è¿™ä¸ªé¡µé¢æ˜¯å¦éœ€è¦éªŒè¯cookie</li>
<li>å°†cookieå¤„ç†æ¨¡å—è¿›è¡Œå…³é—­,å°†ä¼šæå‡scrapyçš„æ‰§è¡Œæ•ˆç‡</li>
</ul>
</li>
<li>ç¦æ­¢é‡è¯•<ul>
<li>scrapyå°†ä¼šè‡ªåŠ¨å¯¹å¤±è´¥çš„è¯·æ±‚è¿›è¡Œé‡è¯•,è¿™ä¸¥é‡å½±å“åˆ°äº†çˆ¬è™«çš„æ‰§è¡Œæ•ˆç‡,å¯ä»¥å°†é‡è¯•åŠŸèƒ½ç¦æ‰,ä»è€Œæå‡æ‰§è¡Œæ•ˆç‡</li>
<li>åœ¨settingsæ–‡ä»¶ä¸­ä¹¦å†™ä»£ç </li>
<li>RETRY_ENABLED = False</li>
<li>å½“è¯·æ±‚å¤±è´¥çš„æ—¶å€™,scrapyå°†ä¸ä¼šå»å¤„ç†è¯·æ±‚å¤±è´¥çš„æ•°æ®,è€Œæ˜¯ä¼šç›´æ¥è·³è¿‡è¿›è¡Œä¸‹ä¸€æ¡</li>
</ul>
</li>
<li>å‡å°‘ä¸‹è½½è¶…æ—¶<ul>
<li>DOWNLOAD_TIMEOUT = 10</li>
<li>å†™å…¥è¿™æ®µä»£ç ,ä½œç”¨æ˜¯è®¾å®šè¯·æ±‚è¶…æ—¶çš„æ—¶é—´,ä¹Ÿå°±æ˜¯è¯´,å½“ä½ åœ¨äº²æ±‚æ—¶é—´è¶…è¿‡äº†åç§’çš„æ—¶å€™ä¾ç„¶æ²¡æœ‰æ‹¿åˆ°æ•°æ®çš„è¯,å°†ä¼šç»“æŸè¯·æ±‚,æ‰§è¡Œä¸‹ä¸€é¡¹,è€Œä¸æ˜¯ä¸€ç›´ç­‰å¾…ä¸‹å»,è¿™ä¸ªç†ŸçŸ¥çš„å•ä½æ˜¯ç§’<h2 id="è¯·æ±‚ä¼ å‚"><a href="#è¯·æ±‚ä¼ å‚" class="headerlink" title="è¯·æ±‚ä¼ å‚:"></a>è¯·æ±‚ä¼ å‚:</h2></li>
</ul>
</li>
</ol>
<ul>
<li>åŸºäºè¯·æ±‚ä¼ å‚å¯ä»¥å®ç°æ·±åº¦çˆ¬å–<ul>
<li>è¯·æ±‚ä¼ å‚,åœ¨è¿›è¡Œscrapy.Requestè¯·æ±‚çš„æ—¶å€™,å¯ä»¥ä½¿ç”¨ç¬¬ä¸‰ä¸ªå‚æ•°meta</li>
<li>è¿™ä¸ªå‚æ•°çš„ä½œç”¨æ˜¯å‘ä¸Šä¸€ä¸ªå‚æ•°callbackè¿™ä¸ªè§£æå‡½æ•°ä¸­ä¼ é€’å‚æ•°,å¥¹çš„æ•°æ®ç±»å‹æ˜¯ä¸€ä¸ªå­—å…¸,é€šè¿‡é”®å€¼å¯¹çš„å½¢å¼å­˜å‚¨éœ€è¦ä¼ é€’çš„æ•°æ®</li>
<li>å½“æˆ‘ä»¬éœ€è¦å°†ä¸Šä¸€ä¸ªè§£æå‡½æ•°ä¸­å®ä¾‹åŒ–å¥½çš„itemå¯¹è±¡ä¼ é€’åˆ°ä¸‹ä¸€ä¸ªè§£æå‡½æ•°ä¸­çš„æ—¶å€™,å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•è¿›è¡Œä¼ é€’</li>
<li>åœ¨å¦ä¸€ä¸ªè§£æå‡½æ•° ä¸­,é€šè¿‡responseå‚æ•°çš„metaå±æ€§å¯ä»¥æ‹¿åˆ°å‚æ•°çš„å†…å®¹å¹¶è¿›è¡Œæå–,è¿™ä¸ªå°±å¯ä»¥æ‹¿åˆ°ä¸Šä¸€ä¸ªå‡½æ•°ä¸­ä¼ é€’è¿‡æ¥çš„itemå¯¹è±¡,å®ç°ä¸åŒè§£æå‡½æ•°ä¹‹é—´çš„è¯·æ±‚ä¼ é€’</li>
<li>é€šè¿‡è¿™ä¸ªæ–¹å¼å¯ä»¥å®ç°æ·±åº¦çˆ¬å–,å³</li>
<li>å½“ä¸€æ•´å¥—æ•°æ®çš„å†…å®¹å¦‚æ ‡é¢˜å’Œç®€ä»‹å­˜åœ¨äºä¸¤ä¸ªå…³è”çš„é¡µé¢ä¸­,é‚£ä¹ˆæˆ‘ä»¬æƒ³è¦åŒæ—¶è·å¾—æ ‡é¢˜å’Œç®€ä»‹,å°±éœ€è¦è¿›è¡Œæ·±åº¦çˆ¬å–,ä½¿ç”¨è¿™ä¸ªæ–¹å¼ä¼ é€’çš„è¯,å°†ä¼šæ›´ç®€ä¾¿çš„å®ç°æ·±åº¦çˆ¬å–çš„è¦æ±‚</li>
</ul>
</li>
</ul>
<h2 id="ä¸­é—´ä»¶"><a href="#ä¸­é—´ä»¶" class="headerlink" title="ä¸­é—´ä»¶:"></a>ä¸­é—´ä»¶:</h2><p>åœ¨åˆ›å»ºå¥½çš„scrapyå·¥ç¨‹ä¸­,è‡ªå¸¦äº†ä¸¤ä¸ªåŸºç¡€çš„ä¸­é—´ä»¶</p>
<p>çˆ¬è™«ä¸­é—´ä»¶TwoSpidersSpiderMiddleware</p>
<p>ä¸‹è½½ä¸­é—´ä»¶TwoSpidersDownloaderMiddleware</p>
<ol>
<li><h3 id="æ‹¦æˆªä¸­é—´ä»¶"><a href="#æ‹¦æˆªä¸­é—´ä»¶" class="headerlink" title="æ‹¦æˆªä¸­é—´ä»¶"></a>æ‹¦æˆªä¸­é—´ä»¶</h3><ol>
<li><p>ä½œç”¨:æ‰¹é‡æ‹¦æˆªè¯·æ±‚</p>
</li>
<li><p>æ‹¦æˆªè¯·æ±‚:</p>
<ul>
<li><p>UAä¼ªè£…</p>
<ul>
<li>ç›®çš„:å°†æ‰€æœ‰çš„è¯·æ±‚çš„è¯·æ±‚å¤´å°½å¯èƒ½å¤šçš„ä¸åŒçš„è¯·æ±‚è½½ä½“æ ‡è¯†</li>
</ul>
</li>
<li><p>ä»£ç†æ“ä½œ</p>
<ul>
<li><pre class=" language-python"><code class="language-python">    <span class="token keyword">def</span> <span class="token function">process_exception</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> exception<span class="token punctuation">,</span> spider<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment" spellcheck="true"># åœ¨é”™è¯¯æ•è·é˜¶æ®µè¿›è¡Œä»£ç†ä¿®æ­£,</span>
        <span class="token keyword">if</span> request<span class="token punctuation">.</span>url<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">':'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'http'</span><span class="token punctuation">:</span>
            request<span class="token punctuation">.</span>meta<span class="token punctuation">[</span><span class="token string">'proxy'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'http://'</span> <span class="token operator">+</span> random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>PROXY_http<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            request<span class="token punctuation">.</span>meta<span class="token punctuation">[</span><span class="token string">'proxy'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'http://'</span> <span class="token operator">+</span> random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>PROXY_https<span class="token punctuation">)</span>
        <span class="token keyword">return</span> request</code></pre>
</li>
<li><pre class=" language-python"><code class="language-python">    <span class="token keyword">def</span> <span class="token function">process_request</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> spider<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment" spellcheck="true"># å®ç°å°†æ‹¦æˆªåˆ°çš„requestè¯·æ±‚å°½å¯èƒ½å¤šçš„è®¾å®šæˆä¸åŒçš„è¯·æ±‚è½½ä½“èº«ä»½æ ‡è¯†</span>
        request<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">'User-Agent'</span><span class="token punctuation">]</span> <span class="token operator">=</span> random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>user_agent_list<span class="token punctuation">)</span>
        <span class="token comment" spellcheck="true"># åœ¨æ¯æ¬¡è¯·æ±‚ä¹‹å‰è¿›è¡Œä»£ç†ä¿®æ­£</span>
        <span class="token keyword">if</span> request<span class="token punctuation">.</span>url<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">':'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'http'</span><span class="token punctuation">:</span>
            request<span class="token punctuation">.</span>meta<span class="token punctuation">[</span><span class="token string">'proxy'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'http://'</span> <span class="token operator">+</span> random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>PROXY_http<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            request<span class="token punctuation">.</span>meta<span class="token punctuation">[</span><span class="token string">'proxy'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'http://'</span> <span class="token operator">+</span> random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>PROXY_https<span class="token punctuation">)</span>
        <span class="token keyword">return</span> None</code></pre>
</li>
</ul>
</li>
</ul>
</li>
<li><p>æ‹¦æˆªå“åº”</p>
<ul>
<li>ç¯¡æ”¹å“åº”å¯¹è±¡æˆ–ç›´æ¥æ›¿æ¢å“åº”å¯¹è±¡</li>
</ul>
</li>
</ol>
</li>
<li><p>ä¸‹è½½ä¸­é—´ä»¶ </p>
<ol>
<li><pre class=" language-python"><code class="language-python"> <span class="token keyword">import</span> scrapy
 <span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver <span class="token keyword">import</span> Chrome<span class="token punctuation">,</span>ChromeOptions
 <span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>chrome<span class="token punctuation">.</span>options <span class="token keyword">import</span> Options
 <span class="token keyword">from</span> wangyi<span class="token punctuation">.</span>items <span class="token keyword">import</span> WangyiItem
 <span class="token comment" spellcheck="true"># åˆ›å»ºoptionså®ä¾‹å¯¹è±¡,å®ç°æ— å¤´æµè§ˆå™¨</span>
 chrome_option <span class="token operator">=</span> Options<span class="token punctuation">(</span><span class="token punctuation">)</span>
 chrome_option<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--headless'</span><span class="token punctuation">)</span>
 chrome_option<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--disable-gpu'</span><span class="token punctuation">)</span>
 <span class="token keyword">class</span> <span class="token class-name">WangyiSpider</span><span class="token punctuation">(</span>scrapy<span class="token punctuation">.</span>Spider<span class="token punctuation">)</span><span class="token punctuation">:</span>
     name <span class="token operator">=</span> <span class="token string">'wangyi'</span>
     <span class="token comment" spellcheck="true"># allowed_domains = ['www.xxx.com']</span>
     <span class="token comment" spellcheck="true"># åŸå§‹urlç½‘é¡µ</span>
     start_urls <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'https://news.163.com/'</span><span class="token punctuation">]</span>
     pro <span class="token operator">=</span> Chrome<span class="token punctuation">(</span>chrome_options<span class="token operator">=</span>chrome_option<span class="token punctuation">)</span>
     <span class="token comment" spellcheck="true"># ç”¨æ¥å­˜å‚¨åç»­çš„æ‰€æœ‰å­é¡µé¢çš„url</span>
     cls_url_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

     <span class="token keyword">def</span> <span class="token function">parse</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token comment" spellcheck="true"># å‡†å¤‡è¦çˆ¬å–çš„ç›®æ ‡</span>
         index_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span>
         li_list <span class="token operator">=</span> response<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="index2016_wrap"]/div[1]/div[2]/div[2]/div[2]/div[2]/div/ul/li'</span><span class="token punctuation">)</span>
         <span class="token comment" spellcheck="true"># print(li_list)</span>
         <span class="token keyword">for</span> index <span class="token keyword">in</span> index_list<span class="token punctuation">:</span>
             li <span class="token operator">=</span> li_list<span class="token punctuation">[</span>index<span class="token punctuation">]</span>
             <span class="token comment" spellcheck="true"># è·å–å­é¡µé¢url</span>
             new_url <span class="token operator">=</span> li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'./a/@href'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract_first<span class="token punctuation">(</span><span class="token punctuation">)</span>
             <span class="token comment" spellcheck="true"># è·å–ç‹¬å½±çš„åˆ†ç±»åç§°</span>
             news <span class="token operator">=</span> li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'./a/text()'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract_first<span class="token punctuation">(</span><span class="token punctuation">)</span>
             <span class="token comment" spellcheck="true"># å°†å­é¡µé¢çš„urlæ·»åŠ åˆ°ç±»å±æ€§ä¸­è¿›è¡Œå­˜å‚¨</span>
             self<span class="token punctuation">.</span>cls_url_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>new_url<span class="token punctuation">)</span>
             <span class="token comment" spellcheck="true"># å¼€å§‹å¯¹å­é¡µé¢è¿›è¡Œè¿‡è¯·æ±‚,å¹¶å°†è¯·æ±‚æ•°æ®äº¤ç»™ä¸‹ä¸€ä¸ªè§£æå‡½æ•°</span>
             <span class="token keyword">yield</span> scrapy<span class="token punctuation">.</span>Request<span class="token punctuation">(</span>url<span class="token operator">=</span>new_url<span class="token punctuation">,</span>callback<span class="token operator">=</span>self<span class="token punctuation">.</span>new_prase<span class="token punctuation">)</span>

     <span class="token keyword">def</span> <span class="token function">new_prase</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>response<span class="token punctuation">)</span><span class="token punctuation">:</span>
         div_list <span class="token operator">=</span> response<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'/html/body/div/div[3]/div[4]/div[1]/div/div/ul/li/div/div'</span><span class="token punctuation">)</span>
         <span class="token keyword">for</span> div <span class="token keyword">in</span> div_list<span class="token punctuation">:</span>
             <span class="token comment" spellcheck="true"># è·å¾—æ–°é—»æ ‡é¢˜ä¸æ–°é—»è¯¦æƒ…é¡µé¢çš„url</span>
             title <span class="token operator">=</span> div<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'./div/div/h3/a/text()'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract_first<span class="token punctuation">(</span><span class="token punctuation">)</span>
             new_url <span class="token operator">=</span> div<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'./div/div/h3/a/@href'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract_first<span class="token punctuation">(</span><span class="token punctuation">)</span>
             <span class="token comment" spellcheck="true"># åˆ›å»ºitemå¯¹è±¡,å¹¶å°†åé¢ä¼šç”¨åˆ°çš„æ ‡é¢˜å­˜å‚¨è¿›å»</span>
             item <span class="token operator">=</span> WangyiItem<span class="token punctuation">(</span><span class="token punctuation">)</span>
             item<span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">]</span> <span class="token operator">=</span> title
             <span class="token comment" spellcheck="true"># å¼€å§‹å¯¹è¯¦æƒ…é¡µé¢è¿›è¡Œè¯·æ±‚,å¹¶å°†è·å–åˆ°çš„é¡µé¢æºç ä¸itemå¯¹è±¡ä¸€èµ·ä¼ é€’ç»™ä¸‹ä¸€ä¸ªè§£æå‡½æ•°</span>
             <span class="token keyword">yield</span> scrapy<span class="token punctuation">.</span>Request<span class="token punctuation">(</span>url<span class="token operator">=</span>new_url<span class="token punctuation">,</span>callback<span class="token operator">=</span>self<span class="token punctuation">.</span>content_parse<span class="token punctuation">,</span>meta<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'item'</span><span class="token punctuation">:</span> item<span class="token punctuation">}</span><span class="token punctuation">)</span>
     <span class="token keyword">def</span> <span class="token function">content_parse</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>response<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token comment" spellcheck="true"># æŠ½å–ä¼ é€’è¿‡æ¥çš„itemå¯¹è±¡</span>
         item <span class="token operator">=</span> response<span class="token punctuation">.</span>meta<span class="token punctuation">[</span><span class="token string">'item'</span><span class="token punctuation">]</span>
         <span class="token comment" spellcheck="true"># è§£ææºç ä¸­çš„å†…å®¹æ•°æ®</span>
         content <span class="token operator">=</span> response<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="endText"]/p/text()'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract<span class="token punctuation">(</span><span class="token punctuation">)</span>
         <span class="token comment" spellcheck="true"># å°†å†…å®¹å­˜å‚¨è¿›itemå¯¹è±¡</span>
         item<span class="token punctuation">[</span><span class="token string">'content'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>content<span class="token punctuation">)</span>
         <span class="token comment" spellcheck="true"># å°†æ•°æ®æäº¤ç»™ç®¡é“</span>
         <span class="token keyword">yield</span> item

     <span class="token keyword">def</span> <span class="token function">closed</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>spider<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token comment" spellcheck="true"># å½“çˆ¬è™«ç»“æŸæ—¶,å…³é—­seleniumæµè§ˆå™¨</span>
         self<span class="token punctuation">.</span>pro<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<p> ä»¥ä¸Šä¸ºçˆ¬è™«æ–‡ä»¶ä¸­çš„æ„é€ </p>
</li>
<li><pre class=" language-python"><code class="language-python"> <span class="token keyword">class</span> <span class="token class-name">WangyiPipeline</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">:</span>
     <span class="token comment" spellcheck="true"># åœ¨çˆ¬è™«å¼€å§‹è¿è¡Œæ—¶è¿›è¡Œæ–‡ä»¶çš„åˆ›å»º</span>
     <span class="token keyword">def</span> <span class="token function">open_spider</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> spider<span class="token punctuation">)</span><span class="token punctuation">:</span>
         self<span class="token punctuation">.</span>fp <span class="token operator">=</span> open<span class="token punctuation">(</span><span class="token string">'./news.txt'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>

     <span class="token comment" spellcheck="true"># å¯¹æäº¤çš„itemæ•°æ®è¿›è¡Œå¤„ç†</span>
     <span class="token keyword">def</span> <span class="token function">process_item</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> item<span class="token punctuation">,</span> spider<span class="token punctuation">)</span><span class="token punctuation">:</span>
         title <span class="token operator">=</span> item<span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">]</span>
         content <span class="token operator">=</span> item<span class="token punctuation">[</span><span class="token string">'content'</span><span class="token punctuation">]</span>
         <span class="token comment" spellcheck="true"># print(item)</span>
         <span class="token comment" spellcheck="true"># å°†itemæ•°æ®è¿›è¡Œå­˜å‚¨</span>
         self<span class="token punctuation">.</span>fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'['</span> <span class="token operator">+</span> <span class="token string">'title'</span> <span class="token operator">+</span> <span class="token string">':'</span> <span class="token operator">+</span> title <span class="token operator">+</span> <span class="token string">','</span> <span class="token operator">+</span> <span class="token string">'content'</span> <span class="token operator">+</span> <span class="token string">':'</span> <span class="token operator">+</span> content <span class="token operator">+</span> <span class="token string">']'</span> <span class="token operator">+</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>
         <span class="token keyword">return</span> item
     <span class="token keyword">def</span> <span class="token function">close_spider</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> spider<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token comment" spellcheck="true"># çˆ¬è™«ç»“æŸæ—¶,å…³é—­æ‰“å¼€çš„æ–‡ä»¶</span>
         self<span class="token punctuation">.</span>fp<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<p> ä»¥ä¸Šä¸ºç®¡é“ä¸­çš„ä»£ç </p>
</li>
<li><pre class=" language-python"><code class="language-python"> <span class="token keyword">from</span> scrapy <span class="token keyword">import</span> signals
 <span class="token keyword">from</span> scrapy<span class="token punctuation">.</span>http <span class="token keyword">import</span> HtmlResponse
 <span class="token keyword">from</span> time <span class="token keyword">import</span> sleep
 <span class="token keyword">class</span> <span class="token class-name">WangyiDownloaderMiddleware</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">:</span>
     <span class="token comment" spellcheck="true"># æ•è·å“åº”æ•°æ®å¹¶è¿›è¡Œæ£€æµ‹</span>
     <span class="token keyword">def</span> <span class="token function">process_response</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> response<span class="token punctuation">,</span> spider<span class="token punctuation">)</span><span class="token punctuation">:</span>
         <span class="token comment" spellcheck="true"># æŠ½å–çˆ¬è™«æ–‡ä»¶ä¸­çš„æ¨¡æ‹Ÿæµè§ˆå™¨</span>
         pro <span class="token operator">=</span> spider<span class="token punctuation">.</span>pro
         <span class="token comment" spellcheck="true"># å¯¹è¯·æ±‚å¯¹è±¡è¿›è¡Œè§£æ,å½“å¯¹è±¡ä¸ºä¸»é¡µé¢çš„æ—¶å€™,æ— è§†</span>
         <span class="token comment" spellcheck="true"># spiderå‚æ•°ä¸ºå®ä¾‹åŒ–çš„çˆ¬è™«ç±»</span>
         <span class="token comment" spellcheck="true"># å¯ä»¥ç›´æ¥è°ƒç”¨çˆ¬è™«ç±»çš„ä¸€äº›æ–¹æ³•</span>
         <span class="token keyword">if</span> request<span class="token punctuation">.</span>url <span class="token keyword">in</span> spider<span class="token punctuation">.</span>cls_url_list<span class="token punctuation">:</span>
             <span class="token comment" spellcheck="true"># é€šè¿‡æ¨¡æ‹Ÿæµè§ˆå™¨å‘èµ·è¯·æ±‚,ç»•å¼€åŠ¨æ€åŠ è½½</span>
             pro<span class="token punctuation">.</span>get<span class="token punctuation">(</span>request<span class="token punctuation">.</span>url<span class="token punctuation">)</span>
             <span class="token comment" spellcheck="true"># ç­‰å¾…ä¸€ç§’,ç¡®ä¿æ•°æ®åŠ è½½å®Œæˆ</span>
             sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
             <span class="token comment" spellcheck="true"># è·å–é¡µé¢æºç </span>
             page_text <span class="token operator">=</span> pro<span class="token punctuation">.</span>page_source
             <span class="token comment" spellcheck="true"># å®ä¾‹åŒ–HtmlResponseå¯¹è±¡</span>
             <span class="token comment" spellcheck="true"># url    è¯·æ±‚çš„urlå¯¹è±¡</span>
             <span class="token comment" spellcheck="true"># body   è¦è¿”å›çš„é¡µé¢æºç æ•°æ®</span>
             <span class="token comment" spellcheck="true"># encoding  è®¾å®šé¡µé¢æºç çš„ç¼–ç æ ¼å¼</span>
             <span class="token comment" spellcheck="true"># request   è¯·æ±‚ä¸å˜</span>
             new_response <span class="token operator">=</span> HtmlResponse<span class="token punctuation">(</span>url<span class="token operator">=</span>request<span class="token punctuation">.</span>url<span class="token punctuation">,</span>body<span class="token operator">=</span>page_text<span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">,</span>request<span class="token operator">=</span>request<span class="token punctuation">)</span>
             <span class="token comment" spellcheck="true"># å°†å‡†å¤‡å¥½çš„æ•°æ®è¿”å›</span>
             <span class="token keyword">return</span> new_response
         <span class="token keyword">return</span> response
</code></pre>
<p> ä»¥ä¸Šä¸ºä¸­é—´ä»¶ä¸­çš„æ•°æ®</p>
</li>
<li><p>åœ¨è¿™ä¸‰ç§æ¨¡å—çš„è¾…åŠ©ä¹‹ä¸‹,å¯ä»¥å®ç°å¯¹ç½‘ç«™æ•°æ®çš„æ·±åº¦çˆ¬å–,å¿…è¦æ—¶,å¯ä»¥æ·»åŠ é¡µç æ•°æ®,ä»è€Œç¡®ä¿è¿™ä¸ªçˆ¬è™«å¯ä»¥ç²¾ç¡®å®šä½åˆ°æ¯ä¸€ä¸ªåˆ†ç±»ä¸‹çš„æ‰€æœ‰æ•°æ®çš„æ¯ä¸€é¡µæ•°æ®,ä¹Ÿå°±æ˜¯è¯´,ä½¿ç”¨scrapyçˆ¬è™«,å¯ä»¥ç›´æ¥å®ç°å¯¹æ•´ä¸ªç›®æ ‡ç½‘ç«™çš„è¦†ç›–æ€§çˆ¬å–æ•°æ®</p>
</li>
<li><p>åŒæ—¶,ç”±äºscrapyé»˜è®¤æ˜¯å¼‚æ­¥è¿è¡Œçš„,è¿™ç§å½¢æ€çš„çˆ¬è™«,å·¥ä½œæ•ˆç‡æ¯”èµ·requestsè¦é«˜å¾—å¤š</p>
</li>
</ol>
</li>
<li><h3 id="UserAgentä¼ªè£…"><a href="#UserAgentä¼ªè£…" class="headerlink" title="UserAgentä¼ªè£…"></a>UserAgentä¼ªè£…</h3><ol>
<li><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> fake_useragent <span class="token keyword">import</span> UserAgent
a <span class="token operator">=</span> UserAgent<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>Chrome<span class="token punctuation">)</span></code></pre>
</li>
</ol>
</li>
</ol>
</div><div id="reward-container"><span class="hty-icon-button button-glow" id="reward-button" title="æ‰“èµ" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === &quot;none&quot;) ? &quot;block&quot; : &quot;none&quot;;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-hand-coin-line"></use></svg></span><div id="reward-comment">æˆ‘å¾ˆå¯çˆ±ï¼Œè¯·ç»™æˆ‘é’±</div><div id="qr" style="display:none;"><div style="display:inline-block"><a href="/images/alipay.png"><img loading="lazy" src="/fcg22450.github.io/images/alipay.png" alt="æ”¯ä»˜å®" title="æ”¯ä»˜å®"></a><div><span style="color:#00A3EE"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-alipay-line"></use></svg></span></div></div><div style="display:inline-block"><a href="/images/qqpay.png"><img loading="lazy" src="/fcg22450.github.io/images/qqpay.png" alt="QQ æ”¯ä»˜" title="QQ æ”¯ä»˜"></a><div><span style="color:#12B7F5"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-qq-line"></use></svg></span></div></div><div style="display:inline-block"><a href="/images/weixin.png"><img loading="lazy" src="/fcg22450.github.io/images/weixin.png" alt="å¾®ä¿¡æ”¯ä»˜" title="å¾®ä¿¡æ”¯ä»˜"></a><div><span style="color:#2DC100"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-wechat-pay-line"></use></svg></span></div></div></div></div><ul class="post-copyright"><li class="post-copyright-author"><strong>æœ¬æ–‡ä½œè€…ï¼š</strong>é€†ã®ç¥æ§˜</li><li class="post-copyright-link"><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong><a href="https://github.com/fcg22450/fcg22450.github.io/2019/05/18/spider/scrapy%E8%AF%A6%E8%A7%A3/" title="scrapyè¯¦è§£">https://github.com/fcg22450/fcg22450.github.io/2019/05/18/spider/scrapy%E8%AF%A6%E8%A7%A3/</a></li><li class="post-copyright-license"><strong>ç‰ˆæƒå£°æ˜ï¼š</strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é»˜è®¤é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><svg class="icon"><use xlink:href="#icon-creative-commons-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-by-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-nc-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-sa-line"></use></svg></a> è®¸å¯åè®®ã€‚</li></ul></section></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/fcg22450.github.io/2019/05/23/spider/selenium%E8%AF%A6%E8%A7%A3/" rel="prev" title="seleniumè¯¦è§£"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-left-s-line"></use></svg><span class="post-nav-text">seleniumè¯¦è§£</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/fcg22450.github.io/2019/05/16/spider/%E5%88%86%E5%B8%83%E5%BC%8F%E7%88%AC%E8%99%AB%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86%E4%B8%8E%E8%BF%90%E8%A1%8C%E6%9C%BA%E5%88%B6/" rel="next" title="åˆ†å¸ƒå¼çˆ¬è™«å®ç°åŸç†ä¸è¿è¡Œæœºåˆ¶"><span class="post-nav-text">åˆ†å¸ƒå¼çˆ¬è™«å®ç°åŸç†ä¸è¿è¡Œæœºåˆ¶</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-right-s-line"></use></svg></a></div></div></div><div id="comment"><div class="comment-tooltip text-center"><span>è‹¥æ‚¨æ—  GitHub è´¦å·ï¼Œå¯ç›´æ¥åœ¨ä¸‹æ–¹åŒ¿åè¯„è®ºã€‚</span><br><span>è‹¥æ‚¨æƒ³åŠæ—¶å¾—åˆ°å›å¤æé†’ï¼Œå»ºè®®è·³è½¬ GitHub Issues è¯„è®ºã€‚</span><br><span>è‹¥æ²¡æœ‰æœ¬æ–‡ Issueï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ Comment æ¨¡ç‰ˆæ–°å»ºã€‚</span><br><a class="hty-button hty-button--raised" id="github-issues" href="https://github.com/fcg22450/fcg22450.github.io/issues?q=is:issue+scrapyè¯¦è§£">GitHub Issues</a></div></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2018 â€“ 2020 </span><span class="with-love" id="animate"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></span><span class="author"> é€†ã®ç¥æ§˜</span></div><div class="powered"><span>ç”± <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> é©±åŠ¨ v4.2.0</span><span class="footer-separator">|</span><span>ä¸»é¢˜ - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v0.6.3</span></div><div class="live_time"><span>æœ¬åšå®¢å·²èŒèŒå“’åœ°è¿è¡Œ</span><span id="display_live_time"></span><span class="moe-text">(â—'â—¡'â—)</span><script>function blog_live_time() {
  window.setTimeout(blog_live_time, 1000);
  const start = new Date('2018-09-12T00:00:00');
  const now = new Date();
  const timeDiff = (now.getTime() - start.getTime());
  const msPerMinute = 60 * 1000;
  const msPerHour = 60 * msPerMinute;
  const msPerDay = 24 * msPerHour;
  const passDay = Math.floor(timeDiff / msPerDay);
  const passHour = Math.floor((timeDiff % msPerDay) / 60 / 60 / 1000);
  const passMinute = Math.floor((timeDiff % msPerHour) / 60 / 1000);
  const passSecond = Math.floor((timeDiff % msPerMinute) / 1000);
  display_live_time.innerHTML = " " + passDay + " å¤© " + passHour + " å°æ—¶ " + passMinute + " åˆ† " + passSecond + " ç§’";
}
blog_live_time();
</script></div><div id="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv" title="æ€»è®¿å®¢é‡"><span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-user-line"></use></svg></span><span id="busuanzi_value_site_uv"></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv" title="æ€»è®¿é—®é‡"><span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-eye-line"></use></svg></span><span id="busuanzi_value_site_pv"></span></span></div></footer><a class="hty-icon-button" id="goUp" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a></div><script defer src="/fcg22450.github.io/js/hexo-theme-yun.js"></script><script src="/fcg22450.github.io/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>